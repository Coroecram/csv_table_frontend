<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Michael Budnick Submission</title>
  <meta name="description" content="Michael Budnick Genesis Trading Submission">
  <meta name="author" content="Michael Budnick">

  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/tabulator.css">
  <link rel="stylesheet" href="css/jquery-ui.css">
  <link rel="stylesheet" href="css/jquery-ui.theme.css">
  <link rel="stylesheet" href="css/jquery-ui.structure.css">

</head>

<body>
  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/jquery-ui.min.js"></script>
  <script src="js/tabulator.min.js"></script>
  <script src="js/papaparse.min.js"></script>
  <script src="js/util.js"></script>
  <script src="js/script.js"></script>

  <input id="upload" type="file" accept=".csv" />
  <div id="csv-table"></div>

  <script id="csv-uploading">
    var data;
    var columns = [];

    document.getElementById("upload").addEventListener("change", upload, false);

    function upload(e) {
      var file = e.target.files[0];

      var reader = new FileReader();
      reader.readAsText(file);
      reader.onload = function (event) {
          var csvData = event.target.result;

          var parsedCSV = Papa.parse(csvData, {'header': true, 'dynamicTyping': true});

          data = parsedCSV.data;
          var headers = Object.keys(data[0])
          console.log(headers)
          columns = [];

          for (var i = 0; i < headers.length; i++) {
            columns[i] = { 'title': toTitleCase(headers[i]),
            'field': headers[i],
            'sortable': true }
          }

          $("#csv-table").tabulator({'columns': columns,
                                      'layout':"fitColumns",
                                      'addRowPos':"top",
                                      'pagination':"local",
                                      'paginationSize':7,
                                      'movableColumns':true,
                                      'resizableRows':true
                                    });
          $("#csv-table").tabulator("setData", data);
      }

    }

  </script>



</body>
</html>
